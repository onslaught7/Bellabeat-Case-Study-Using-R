{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "3a0a7e5e",
   "metadata": {
    "papermill": {
     "duration": 0.006954,
     "end_time": "2024-09-10T04:48:04.867531",
     "exception": false,
     "start_time": "2024-09-10T04:48:04.860577",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# <span style=\"color: #20beff;\">Bellabeat Case Study (Google Data Analytics Professional Certificate Capstone)</span>\n",
    "\n",
    "Urška Sršen and Sando Mur founded Bellabeat, a high-tech company that manufactures health-focused smart products. Collecting data on activity, sleep, stress, and reproductive health has allowed Bellabeat to empower women with knowledge about their own health and habits. Since it was founded in .2013, Bellabeat has grown rapidly and quickly positioned  itself as a tech-driven wellness company for women.\n",
    "\n",
    "By 2016, Bellabeat had opened offices around the world and launched multiple products. Bellabeat products became available through a growing number of online retailers in addition to their own e-commerce channel on their website. The company has invested in traditional advertising media, such as radio, out-of-home billboards, print, and television, but focuses on digital marketing extensively. Bellabeat invests year-round in Google Search, maintaining active Facebook and Instagram pages, and consistently engages consumers on Twitter. Additionally, Bellabeat runs video ads on Youtube and display ads on the Google Display Network to support campaigns around key marketing dates.\n",
    "\n",
    "Sršen knows that an analysis of Bellabeat’s available consumer data would reveal more opportunities for growth. She has asked the marketing analytics team to focus on a Bellabeat product and analyze smart device usage data in order to gain insight into how people are already using their smart devices. Then, using this information, she would like high-level recommendations for how these trends can inform Bellabeat marketing strategy.\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5e985ca5",
   "metadata": {
    "papermill": {
     "duration": 0.006268,
     "end_time": "2024-09-10T04:48:04.880246",
     "exception": false,
     "start_time": "2024-09-10T04:48:04.873978",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Scenario\n",
    "\n",
    "* I am a **Junior Data Analyst** working on the marketing analyst team at Bellabeat, a high-tech manufacturer of health-focused products for women. \n",
    "* Bellabeat has the potential to become even larger than what it is in the global smart device market.\n",
    "* I have been asked to  focus on one of Bellabeat’s products and analyze smart device data to gain insight into how consumers are using their smart devices\n",
    "* Finally I present my analysis to the executive team along with my recommendations for improving Bellabeat's marketing strategy."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1d88adc0",
   "metadata": {
    "papermill": {
     "duration": 0.006521,
     "end_time": "2024-09-10T04:48:04.893030",
     "exception": false,
     "start_time": "2024-09-10T04:48:04.886509",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# <span style=\"color: #20beff;\">The complete analysis process</span>\n",
    "​\n",
    "We perform the complete analysis process of this case study based of Google's six steps procedure for data analysis, namely:\n",
    "* **Ask**: Identifying the business task, considering the key stakeholders\n",
    "* **Prepare**: Preparing the dataset to be used including checking (ROCCC)\n",
    "* **Process**: The cleaning, sorting and filtering process to prep the data for calculations and analysis\n",
    "* **Analyze**: Putting the clean data to work, performing calculations and searching for trends or insights\n",
    "* **Share**: Communicating your high-level insights and recommendations, this is where visualization comes into action\n",
    "* **Act**: The final conclusion, how the team and business should apply you insights and what next steps can be taken"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "adeddff3",
   "metadata": {
    "papermill": {
     "duration": 0.006399,
     "end_time": "2024-09-10T04:48:04.905693",
     "exception": false,
     "start_time": "2024-09-10T04:48:04.899294",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# <span style=\"color: #20beff;\">1. ASK Phase </span>\n",
    "\n",
    "## Business Task\n",
    "Help Bellabeat make better marketting decisions through analysis of fitness data from non bellabeat smart devices. In our case we use the **FitBit Fitness Tracker Data** \n",
    "\n",
    "## Key Stakeholders\n",
    "* **Urška Sršen**: Bellabeat’s cofounder and Chief Creative Officer\n",
    "* **Sando Mur**: Mathematician and Bellabeat’s cofounder; key member of the Bellabeat executive team\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4d26f074",
   "metadata": {
    "papermill": {
     "duration": 0.006267,
     "end_time": "2024-09-10T04:48:04.918247",
     "exception": false,
     "start_time": "2024-09-10T04:48:04.911980",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# <span style=\"color: #20beff;\">2. PREPARE Phase </span>\n",
    "\n",
    "## Dataset Used:\n",
    "The dataset used for this case study is the FitBit Fitness Tracker Dataset. \n",
    "\n",
    "## Accessibility: \n",
    "It is an open-source dataset made available to the public domain.\n",
    "\n",
    "## Data collection description: \n",
    "It was generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a90d61a8",
   "metadata": {
    "papermill": {
     "duration": 0.006254,
     "end_time": "2024-09-10T04:48:04.930912",
     "exception": false,
     "start_time": "2024-09-10T04:48:04.924658",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Loading the required Packages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "9489533b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:04.947953Z",
     "iopub.status.busy": "2024-09-10T04:48:04.945656Z",
     "iopub.status.idle": "2024-09-10T04:48:06.328122Z",
     "shell.execute_reply": "2024-09-10T04:48:06.326246Z"
    },
    "papermill": {
     "duration": 1.393734,
     "end_time": "2024-09-10T04:48:06.330858",
     "exception": false,
     "start_time": "2024-09-10T04:48:04.937124",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "── \u001b[1mAttaching core tidyverse packages\u001b[22m ──────────────────────── tidyverse 2.0.0 ──\n",
      "\u001b[32m✔\u001b[39m \u001b[34mdplyr    \u001b[39m 1.1.4     \u001b[32m✔\u001b[39m \u001b[34mreadr    \u001b[39m 2.1.5\n",
      "\u001b[32m✔\u001b[39m \u001b[34mforcats  \u001b[39m 1.0.0     \u001b[32m✔\u001b[39m \u001b[34mstringr  \u001b[39m 1.5.1\n",
      "\u001b[32m✔\u001b[39m \u001b[34mggplot2  \u001b[39m 3.5.1     \u001b[32m✔\u001b[39m \u001b[34mtibble   \u001b[39m 3.2.1\n",
      "\u001b[32m✔\u001b[39m \u001b[34mlubridate\u001b[39m 1.9.3     \u001b[32m✔\u001b[39m \u001b[34mtidyr    \u001b[39m 1.3.1\n",
      "\u001b[32m✔\u001b[39m \u001b[34mpurrr    \u001b[39m 1.0.2     \n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n",
      "\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m masks \u001b[34mstats\u001b[39m::filter()\n",
      "\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m    masks \u001b[34mstats\u001b[39m::lag()\n",
      "\u001b[36mℹ\u001b[39m Use the conflicted package (\u001b[3m\u001b[34m<http://conflicted.r-lib.org/>\u001b[39m\u001b[23m) to force all conflicts to become errors\n"
     ]
    }
   ],
   "source": [
    "library(tidyverse)\n",
    "library(lubridate)\n",
    "library(dplyr)\n",
    "library(ggplot2)\n",
    "library(tidyr)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4a4c93b4",
   "metadata": {
    "papermill": {
     "duration": 0.007148,
     "end_time": "2024-09-10T04:48:06.345370",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.338222",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Reading the data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "bae347d7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:06.395863Z",
     "iopub.status.busy": "2024-09-10T04:48:06.360398Z",
     "iopub.status.idle": "2024-09-10T04:48:06.528113Z",
     "shell.execute_reply": "2024-09-10T04:48:06.526160Z"
    },
    "papermill": {
     "duration": 0.179845,
     "end_time": "2024-09-10T04:48:06.531551",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.351706",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "daily_activity <- read.csv(\"/kaggle/input/fitbit/mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv\")\n",
    "daily_calories <- read.csv('/kaggle/input/fitbit/mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/dailyCalories_merged.csv')\n",
    "daily_steps <- read.csv('/kaggle/input/fitbit/mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/dailySteps_merged.csv')\n",
    "daily_intensities <- read.csv('/kaggle/input/fitbit/mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/dailyIntensities_merged.csv')\n",
    "daily_sleep <- read.csv('/kaggle/input/fitbit/mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv')\n",
    "hourly_intensities <- read.csv('/kaggle/input/fitbit/mturkfitbit_export_4.12.16-5.12.16/Fitabase Data 4.12.16-5.12.16/hourlyIntensities_merged.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "36e12589",
   "metadata": {
    "papermill": {
     "duration": 0.00637,
     "end_time": "2024-09-10T04:48:06.544666",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.538296",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# <span style=\"color: #20beff;\">3. PROCESS and ANALYSE Phase </span>\n",
    "​\n",
    "## Tools Used: \n",
    "I am using R markdown for this case study due to it's effective data analysis and processing libraries such as tidyverse, lubridate etc. It also supports for great visualization through libraries like ggplot2. I have done the same case study using Python as well, which is equally as great in terms of tools for this analysis task but not as effective for visualization, in terms of easo of use (personal opinion and not an established fact)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "b28ad2c2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:06.561553Z",
     "iopub.status.busy": "2024-09-10T04:48:06.559879Z",
     "iopub.status.idle": "2024-09-10T04:48:06.619726Z",
     "shell.execute_reply": "2024-09-10T04:48:06.617212Z"
    },
    "papermill": {
     "duration": 0.071623,
     "end_time": "2024-09-10T04:48:06.622875",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.551252",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "'data.frame':\t940 obs. of  15 variables:\n",
      " $ Id                      : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...\n",
      " $ ActivityDate            : chr  \"4/12/2016\" \"4/13/2016\" \"4/14/2016\" \"4/15/2016\" ...\n",
      " $ TotalSteps              : int  13162 10735 10460 9762 12669 9705 13019 15506 10544 9819 ...\n",
      " $ TotalDistance           : num  8.5 6.97 6.74 6.28 8.16 ...\n",
      " $ TrackerDistance         : num  8.5 6.97 6.74 6.28 8.16 ...\n",
      " $ LoggedActivitiesDistance: num  0 0 0 0 0 0 0 0 0 0 ...\n",
      " $ VeryActiveDistance      : num  1.88 1.57 2.44 2.14 2.71 ...\n",
      " $ ModeratelyActiveDistance: num  0.55 0.69 0.4 1.26 0.41 ...\n",
      " $ LightActiveDistance     : num  6.06 4.71 3.91 2.83 5.04 ...\n",
      " $ SedentaryActiveDistance : num  0 0 0 0 0 0 0 0 0 0 ...\n",
      " $ VeryActiveMinutes       : int  25 21 30 29 36 38 42 50 28 19 ...\n",
      " $ FairlyActiveMinutes     : int  13 19 11 34 10 20 16 31 12 8 ...\n",
      " $ LightlyActiveMinutes    : int  328 217 181 209 221 164 233 264 205 211 ...\n",
      " $ SedentaryMinutes        : int  728 776 1218 726 773 539 1149 775 818 838 ...\n",
      " $ Calories                : int  1985 1797 1776 1745 1863 1728 1921 2035 1786 1775 ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 6 × 15</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>Id</th><th scope=col>ActivityDate</th><th scope=col>TotalSteps</th><th scope=col>TotalDistance</th><th scope=col>TrackerDistance</th><th scope=col>LoggedActivitiesDistance</th><th scope=col>VeryActiveDistance</th><th scope=col>ModeratelyActiveDistance</th><th scope=col>LightActiveDistance</th><th scope=col>SedentaryActiveDistance</th><th scope=col>VeryActiveMinutes</th><th scope=col>FairlyActiveMinutes</th><th scope=col>LightlyActiveMinutes</th><th scope=col>SedentaryMinutes</th><th scope=col>Calories</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>1</th><td>1503960366</td><td>4/12/2016</td><td>13162</td><td>8.50</td><td>8.50</td><td>0</td><td>1.88</td><td>0.55</td><td>6.06</td><td>0</td><td>25</td><td>13</td><td>328</td><td> 728</td><td>1985</td></tr>\n",
       "\t<tr><th scope=row>2</th><td>1503960366</td><td>4/13/2016</td><td>10735</td><td>6.97</td><td>6.97</td><td>0</td><td>1.57</td><td>0.69</td><td>4.71</td><td>0</td><td>21</td><td>19</td><td>217</td><td> 776</td><td>1797</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>1503960366</td><td>4/14/2016</td><td>10460</td><td>6.74</td><td>6.74</td><td>0</td><td>2.44</td><td>0.40</td><td>3.91</td><td>0</td><td>30</td><td>11</td><td>181</td><td>1218</td><td>1776</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>1503960366</td><td>4/15/2016</td><td> 9762</td><td>6.28</td><td>6.28</td><td>0</td><td>2.14</td><td>1.26</td><td>2.83</td><td>0</td><td>29</td><td>34</td><td>209</td><td> 726</td><td>1745</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>1503960366</td><td>4/16/2016</td><td>12669</td><td>8.16</td><td>8.16</td><td>0</td><td>2.71</td><td>0.41</td><td>5.04</td><td>0</td><td>36</td><td>10</td><td>221</td><td> 773</td><td>1863</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>1503960366</td><td>4/17/2016</td><td> 9705</td><td>6.48</td><td>6.48</td><td>0</td><td>3.19</td><td>0.78</td><td>2.51</td><td>0</td><td>38</td><td>20</td><td>164</td><td> 539</td><td>1728</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 6 × 15\n",
       "\\begin{tabular}{r|lllllllllllllll}\n",
       "  & Id & ActivityDate & TotalSteps & TotalDistance & TrackerDistance & LoggedActivitiesDistance & VeryActiveDistance & ModeratelyActiveDistance & LightActiveDistance & SedentaryActiveDistance & VeryActiveMinutes & FairlyActiveMinutes & LightlyActiveMinutes & SedentaryMinutes & Calories\\\\\n",
       "  & <dbl> & <chr> & <int> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <int> & <int> & <int> & <int> & <int>\\\\\n",
       "\\hline\n",
       "\t1 & 1503960366 & 4/12/2016 & 13162 & 8.50 & 8.50 & 0 & 1.88 & 0.55 & 6.06 & 0 & 25 & 13 & 328 &  728 & 1985\\\\\n",
       "\t2 & 1503960366 & 4/13/2016 & 10735 & 6.97 & 6.97 & 0 & 1.57 & 0.69 & 4.71 & 0 & 21 & 19 & 217 &  776 & 1797\\\\\n",
       "\t3 & 1503960366 & 4/14/2016 & 10460 & 6.74 & 6.74 & 0 & 2.44 & 0.40 & 3.91 & 0 & 30 & 11 & 181 & 1218 & 1776\\\\\n",
       "\t4 & 1503960366 & 4/15/2016 &  9762 & 6.28 & 6.28 & 0 & 2.14 & 1.26 & 2.83 & 0 & 29 & 34 & 209 &  726 & 1745\\\\\n",
       "\t5 & 1503960366 & 4/16/2016 & 12669 & 8.16 & 8.16 & 0 & 2.71 & 0.41 & 5.04 & 0 & 36 & 10 & 221 &  773 & 1863\\\\\n",
       "\t6 & 1503960366 & 4/17/2016 &  9705 & 6.48 & 6.48 & 0 & 3.19 & 0.78 & 2.51 & 0 & 38 & 20 & 164 &  539 & 1728\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 6 × 15\n",
       "\n",
       "| <!--/--> | Id &lt;dbl&gt; | ActivityDate &lt;chr&gt; | TotalSteps &lt;int&gt; | TotalDistance &lt;dbl&gt; | TrackerDistance &lt;dbl&gt; | LoggedActivitiesDistance &lt;dbl&gt; | VeryActiveDistance &lt;dbl&gt; | ModeratelyActiveDistance &lt;dbl&gt; | LightActiveDistance &lt;dbl&gt; | SedentaryActiveDistance &lt;dbl&gt; | VeryActiveMinutes &lt;int&gt; | FairlyActiveMinutes &lt;int&gt; | LightlyActiveMinutes &lt;int&gt; | SedentaryMinutes &lt;int&gt; | Calories &lt;int&gt; |\n",
       "|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| 1 | 1503960366 | 4/12/2016 | 13162 | 8.50 | 8.50 | 0 | 1.88 | 0.55 | 6.06 | 0 | 25 | 13 | 328 |  728 | 1985 |\n",
       "| 2 | 1503960366 | 4/13/2016 | 10735 | 6.97 | 6.97 | 0 | 1.57 | 0.69 | 4.71 | 0 | 21 | 19 | 217 |  776 | 1797 |\n",
       "| 3 | 1503960366 | 4/14/2016 | 10460 | 6.74 | 6.74 | 0 | 2.44 | 0.40 | 3.91 | 0 | 30 | 11 | 181 | 1218 | 1776 |\n",
       "| 4 | 1503960366 | 4/15/2016 |  9762 | 6.28 | 6.28 | 0 | 2.14 | 1.26 | 2.83 | 0 | 29 | 34 | 209 |  726 | 1745 |\n",
       "| 5 | 1503960366 | 4/16/2016 | 12669 | 8.16 | 8.16 | 0 | 2.71 | 0.41 | 5.04 | 0 | 36 | 10 | 221 |  773 | 1863 |\n",
       "| 6 | 1503960366 | 4/17/2016 |  9705 | 6.48 | 6.48 | 0 | 3.19 | 0.78 | 2.51 | 0 | 38 | 20 | 164 |  539 | 1728 |\n",
       "\n"
      ],
      "text/plain": [
       "  Id         ActivityDate TotalSteps TotalDistance TrackerDistance\n",
       "1 1503960366 4/12/2016    13162      8.50          8.50           \n",
       "2 1503960366 4/13/2016    10735      6.97          6.97           \n",
       "3 1503960366 4/14/2016    10460      6.74          6.74           \n",
       "4 1503960366 4/15/2016     9762      6.28          6.28           \n",
       "5 1503960366 4/16/2016    12669      8.16          8.16           \n",
       "6 1503960366 4/17/2016     9705      6.48          6.48           \n",
       "  LoggedActivitiesDistance VeryActiveDistance ModeratelyActiveDistance\n",
       "1 0                        1.88               0.55                    \n",
       "2 0                        1.57               0.69                    \n",
       "3 0                        2.44               0.40                    \n",
       "4 0                        2.14               1.26                    \n",
       "5 0                        2.71               0.41                    \n",
       "6 0                        3.19               0.78                    \n",
       "  LightActiveDistance SedentaryActiveDistance VeryActiveMinutes\n",
       "1 6.06                0                       25               \n",
       "2 4.71                0                       21               \n",
       "3 3.91                0                       30               \n",
       "4 2.83                0                       29               \n",
       "5 5.04                0                       36               \n",
       "6 2.51                0                       38               \n",
       "  FairlyActiveMinutes LightlyActiveMinutes SedentaryMinutes Calories\n",
       "1 13                  328                   728             1985    \n",
       "2 19                  217                   776             1797    \n",
       "3 11                  181                  1218             1776    \n",
       "4 34                  209                   726             1745    \n",
       "5 10                  221                   773             1863    \n",
       "6 20                  164                   539             1728    "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "str(daily_activity)\n",
    "head(daily_activity)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "d6d871a5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:06.640688Z",
     "iopub.status.busy": "2024-09-10T04:48:06.639088Z",
     "iopub.status.idle": "2024-09-10T04:48:06.674128Z",
     "shell.execute_reply": "2024-09-10T04:48:06.671681Z"
    },
    "papermill": {
     "duration": 0.047841,
     "end_time": "2024-09-10T04:48:06.677654",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.629813",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "'data.frame':\t940 obs. of  3 variables:\n",
      " $ Id         : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...\n",
      " $ ActivityDay: chr  \"4/12/2016\" \"4/13/2016\" \"4/14/2016\" \"4/15/2016\" ...\n",
      " $ Calories   : int  1985 1797 1776 1745 1863 1728 1921 2035 1786 1775 ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 6 × 3</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>Id</th><th scope=col>ActivityDay</th><th scope=col>Calories</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>1</th><td>1503960366</td><td>4/12/2016</td><td>1985</td></tr>\n",
       "\t<tr><th scope=row>2</th><td>1503960366</td><td>4/13/2016</td><td>1797</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>1503960366</td><td>4/14/2016</td><td>1776</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>1503960366</td><td>4/15/2016</td><td>1745</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>1503960366</td><td>4/16/2016</td><td>1863</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>1503960366</td><td>4/17/2016</td><td>1728</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 6 × 3\n",
       "\\begin{tabular}{r|lll}\n",
       "  & Id & ActivityDay & Calories\\\\\n",
       "  & <dbl> & <chr> & <int>\\\\\n",
       "\\hline\n",
       "\t1 & 1503960366 & 4/12/2016 & 1985\\\\\n",
       "\t2 & 1503960366 & 4/13/2016 & 1797\\\\\n",
       "\t3 & 1503960366 & 4/14/2016 & 1776\\\\\n",
       "\t4 & 1503960366 & 4/15/2016 & 1745\\\\\n",
       "\t5 & 1503960366 & 4/16/2016 & 1863\\\\\n",
       "\t6 & 1503960366 & 4/17/2016 & 1728\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 6 × 3\n",
       "\n",
       "| <!--/--> | Id &lt;dbl&gt; | ActivityDay &lt;chr&gt; | Calories &lt;int&gt; |\n",
       "|---|---|---|---|\n",
       "| 1 | 1503960366 | 4/12/2016 | 1985 |\n",
       "| 2 | 1503960366 | 4/13/2016 | 1797 |\n",
       "| 3 | 1503960366 | 4/14/2016 | 1776 |\n",
       "| 4 | 1503960366 | 4/15/2016 | 1745 |\n",
       "| 5 | 1503960366 | 4/16/2016 | 1863 |\n",
       "| 6 | 1503960366 | 4/17/2016 | 1728 |\n",
       "\n"
      ],
      "text/plain": [
       "  Id         ActivityDay Calories\n",
       "1 1503960366 4/12/2016   1985    \n",
       "2 1503960366 4/13/2016   1797    \n",
       "3 1503960366 4/14/2016   1776    \n",
       "4 1503960366 4/15/2016   1745    \n",
       "5 1503960366 4/16/2016   1863    \n",
       "6 1503960366 4/17/2016   1728    "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "str(daily_calories)\n",
    "head(daily_calories)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "56bff735",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:06.695950Z",
     "iopub.status.busy": "2024-09-10T04:48:06.694161Z",
     "iopub.status.idle": "2024-09-10T04:48:06.733354Z",
     "shell.execute_reply": "2024-09-10T04:48:06.731540Z"
    },
    "papermill": {
     "duration": 0.051069,
     "end_time": "2024-09-10T04:48:06.735840",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.684771",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "'data.frame':\t940 obs. of  3 variables:\n",
      " $ Id         : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...\n",
      " $ ActivityDay: chr  \"4/12/2016\" \"4/13/2016\" \"4/14/2016\" \"4/15/2016\" ...\n",
      " $ StepTotal  : int  13162 10735 10460 9762 12669 9705 13019 15506 10544 9819 ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 6 × 3</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>Id</th><th scope=col>ActivityDay</th><th scope=col>StepTotal</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>1</th><td>1503960366</td><td>4/12/2016</td><td>13162</td></tr>\n",
       "\t<tr><th scope=row>2</th><td>1503960366</td><td>4/13/2016</td><td>10735</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>1503960366</td><td>4/14/2016</td><td>10460</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>1503960366</td><td>4/15/2016</td><td> 9762</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>1503960366</td><td>4/16/2016</td><td>12669</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>1503960366</td><td>4/17/2016</td><td> 9705</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 6 × 3\n",
       "\\begin{tabular}{r|lll}\n",
       "  & Id & ActivityDay & StepTotal\\\\\n",
       "  & <dbl> & <chr> & <int>\\\\\n",
       "\\hline\n",
       "\t1 & 1503960366 & 4/12/2016 & 13162\\\\\n",
       "\t2 & 1503960366 & 4/13/2016 & 10735\\\\\n",
       "\t3 & 1503960366 & 4/14/2016 & 10460\\\\\n",
       "\t4 & 1503960366 & 4/15/2016 &  9762\\\\\n",
       "\t5 & 1503960366 & 4/16/2016 & 12669\\\\\n",
       "\t6 & 1503960366 & 4/17/2016 &  9705\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 6 × 3\n",
       "\n",
       "| <!--/--> | Id &lt;dbl&gt; | ActivityDay &lt;chr&gt; | StepTotal &lt;int&gt; |\n",
       "|---|---|---|---|\n",
       "| 1 | 1503960366 | 4/12/2016 | 13162 |\n",
       "| 2 | 1503960366 | 4/13/2016 | 10735 |\n",
       "| 3 | 1503960366 | 4/14/2016 | 10460 |\n",
       "| 4 | 1503960366 | 4/15/2016 |  9762 |\n",
       "| 5 | 1503960366 | 4/16/2016 | 12669 |\n",
       "| 6 | 1503960366 | 4/17/2016 |  9705 |\n",
       "\n"
      ],
      "text/plain": [
       "  Id         ActivityDay StepTotal\n",
       "1 1503960366 4/12/2016   13162    \n",
       "2 1503960366 4/13/2016   10735    \n",
       "3 1503960366 4/14/2016   10460    \n",
       "4 1503960366 4/15/2016    9762    \n",
       "5 1503960366 4/16/2016   12669    \n",
       "6 1503960366 4/17/2016    9705    "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "str(daily_steps)\n",
    "head(daily_steps)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "52dfabb1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:06.755399Z",
     "iopub.status.busy": "2024-09-10T04:48:06.752960Z",
     "iopub.status.idle": "2024-09-10T04:48:06.794935Z",
     "shell.execute_reply": "2024-09-10T04:48:06.792919Z"
    },
    "papermill": {
     "duration": 0.054383,
     "end_time": "2024-09-10T04:48:06.797634",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.743251",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "'data.frame':\t940 obs. of  10 variables:\n",
      " $ Id                      : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...\n",
      " $ ActivityDay             : chr  \"4/12/2016\" \"4/13/2016\" \"4/14/2016\" \"4/15/2016\" ...\n",
      " $ SedentaryMinutes        : int  728 776 1218 726 773 539 1149 775 818 838 ...\n",
      " $ LightlyActiveMinutes    : int  328 217 181 209 221 164 233 264 205 211 ...\n",
      " $ FairlyActiveMinutes     : int  13 19 11 34 10 20 16 31 12 8 ...\n",
      " $ VeryActiveMinutes       : int  25 21 30 29 36 38 42 50 28 19 ...\n",
      " $ SedentaryActiveDistance : num  0 0 0 0 0 0 0 0 0 0 ...\n",
      " $ LightActiveDistance     : num  6.06 4.71 3.91 2.83 5.04 ...\n",
      " $ ModeratelyActiveDistance: num  0.55 0.69 0.4 1.26 0.41 ...\n",
      " $ VeryActiveDistance      : num  1.88 1.57 2.44 2.14 2.71 ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 6 × 10</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>Id</th><th scope=col>ActivityDay</th><th scope=col>SedentaryMinutes</th><th scope=col>LightlyActiveMinutes</th><th scope=col>FairlyActiveMinutes</th><th scope=col>VeryActiveMinutes</th><th scope=col>SedentaryActiveDistance</th><th scope=col>LightActiveDistance</th><th scope=col>ModeratelyActiveDistance</th><th scope=col>VeryActiveDistance</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>1</th><td>1503960366</td><td>4/12/2016</td><td> 728</td><td>328</td><td>13</td><td>25</td><td>0</td><td>6.06</td><td>0.55</td><td>1.88</td></tr>\n",
       "\t<tr><th scope=row>2</th><td>1503960366</td><td>4/13/2016</td><td> 776</td><td>217</td><td>19</td><td>21</td><td>0</td><td>4.71</td><td>0.69</td><td>1.57</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>1503960366</td><td>4/14/2016</td><td>1218</td><td>181</td><td>11</td><td>30</td><td>0</td><td>3.91</td><td>0.40</td><td>2.44</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>1503960366</td><td>4/15/2016</td><td> 726</td><td>209</td><td>34</td><td>29</td><td>0</td><td>2.83</td><td>1.26</td><td>2.14</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>1503960366</td><td>4/16/2016</td><td> 773</td><td>221</td><td>10</td><td>36</td><td>0</td><td>5.04</td><td>0.41</td><td>2.71</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>1503960366</td><td>4/17/2016</td><td> 539</td><td>164</td><td>20</td><td>38</td><td>0</td><td>2.51</td><td>0.78</td><td>3.19</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 6 × 10\n",
       "\\begin{tabular}{r|llllllllll}\n",
       "  & Id & ActivityDay & SedentaryMinutes & LightlyActiveMinutes & FairlyActiveMinutes & VeryActiveMinutes & SedentaryActiveDistance & LightActiveDistance & ModeratelyActiveDistance & VeryActiveDistance\\\\\n",
       "  & <dbl> & <chr> & <int> & <int> & <int> & <int> & <dbl> & <dbl> & <dbl> & <dbl>\\\\\n",
       "\\hline\n",
       "\t1 & 1503960366 & 4/12/2016 &  728 & 328 & 13 & 25 & 0 & 6.06 & 0.55 & 1.88\\\\\n",
       "\t2 & 1503960366 & 4/13/2016 &  776 & 217 & 19 & 21 & 0 & 4.71 & 0.69 & 1.57\\\\\n",
       "\t3 & 1503960366 & 4/14/2016 & 1218 & 181 & 11 & 30 & 0 & 3.91 & 0.40 & 2.44\\\\\n",
       "\t4 & 1503960366 & 4/15/2016 &  726 & 209 & 34 & 29 & 0 & 2.83 & 1.26 & 2.14\\\\\n",
       "\t5 & 1503960366 & 4/16/2016 &  773 & 221 & 10 & 36 & 0 & 5.04 & 0.41 & 2.71\\\\\n",
       "\t6 & 1503960366 & 4/17/2016 &  539 & 164 & 20 & 38 & 0 & 2.51 & 0.78 & 3.19\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 6 × 10\n",
       "\n",
       "| <!--/--> | Id &lt;dbl&gt; | ActivityDay &lt;chr&gt; | SedentaryMinutes &lt;int&gt; | LightlyActiveMinutes &lt;int&gt; | FairlyActiveMinutes &lt;int&gt; | VeryActiveMinutes &lt;int&gt; | SedentaryActiveDistance &lt;dbl&gt; | LightActiveDistance &lt;dbl&gt; | ModeratelyActiveDistance &lt;dbl&gt; | VeryActiveDistance &lt;dbl&gt; |\n",
       "|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| 1 | 1503960366 | 4/12/2016 |  728 | 328 | 13 | 25 | 0 | 6.06 | 0.55 | 1.88 |\n",
       "| 2 | 1503960366 | 4/13/2016 |  776 | 217 | 19 | 21 | 0 | 4.71 | 0.69 | 1.57 |\n",
       "| 3 | 1503960366 | 4/14/2016 | 1218 | 181 | 11 | 30 | 0 | 3.91 | 0.40 | 2.44 |\n",
       "| 4 | 1503960366 | 4/15/2016 |  726 | 209 | 34 | 29 | 0 | 2.83 | 1.26 | 2.14 |\n",
       "| 5 | 1503960366 | 4/16/2016 |  773 | 221 | 10 | 36 | 0 | 5.04 | 0.41 | 2.71 |\n",
       "| 6 | 1503960366 | 4/17/2016 |  539 | 164 | 20 | 38 | 0 | 2.51 | 0.78 | 3.19 |\n",
       "\n"
      ],
      "text/plain": [
       "  Id         ActivityDay SedentaryMinutes LightlyActiveMinutes\n",
       "1 1503960366 4/12/2016    728             328                 \n",
       "2 1503960366 4/13/2016    776             217                 \n",
       "3 1503960366 4/14/2016   1218             181                 \n",
       "4 1503960366 4/15/2016    726             209                 \n",
       "5 1503960366 4/16/2016    773             221                 \n",
       "6 1503960366 4/17/2016    539             164                 \n",
       "  FairlyActiveMinutes VeryActiveMinutes SedentaryActiveDistance\n",
       "1 13                  25                0                      \n",
       "2 19                  21                0                      \n",
       "3 11                  30                0                      \n",
       "4 34                  29                0                      \n",
       "5 10                  36                0                      \n",
       "6 20                  38                0                      \n",
       "  LightActiveDistance ModeratelyActiveDistance VeryActiveDistance\n",
       "1 6.06                0.55                     1.88              \n",
       "2 4.71                0.69                     1.57              \n",
       "3 3.91                0.40                     2.44              \n",
       "4 2.83                1.26                     2.14              \n",
       "5 5.04                0.41                     2.71              \n",
       "6 2.51                0.78                     3.19              "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "str(daily_intensities)\n",
    "head(daily_intensities)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "ace7617d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:06.817434Z",
     "iopub.status.busy": "2024-09-10T04:48:06.815726Z",
     "iopub.status.idle": "2024-09-10T04:48:06.852322Z",
     "shell.execute_reply": "2024-09-10T04:48:06.849704Z"
    },
    "papermill": {
     "duration": 0.050107,
     "end_time": "2024-09-10T04:48:06.855769",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.805662",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "'data.frame':\t413 obs. of  5 variables:\n",
      " $ Id                : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...\n",
      " $ SleepDay          : chr  \"4/12/2016 12:00:00 AM\" \"4/13/2016 12:00:00 AM\" \"4/15/2016 12:00:00 AM\" \"4/16/2016 12:00:00 AM\" ...\n",
      " $ TotalSleepRecords : int  1 2 1 2 1 1 1 1 1 1 ...\n",
      " $ TotalMinutesAsleep: int  327 384 412 340 700 304 360 325 361 430 ...\n",
      " $ TotalTimeInBed    : int  346 407 442 367 712 320 377 364 384 449 ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 6 × 5</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>Id</th><th scope=col>SleepDay</th><th scope=col>TotalSleepRecords</th><th scope=col>TotalMinutesAsleep</th><th scope=col>TotalTimeInBed</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>1</th><td>1503960366</td><td>4/12/2016 12:00:00 AM</td><td>1</td><td>327</td><td>346</td></tr>\n",
       "\t<tr><th scope=row>2</th><td>1503960366</td><td>4/13/2016 12:00:00 AM</td><td>2</td><td>384</td><td>407</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>1503960366</td><td>4/15/2016 12:00:00 AM</td><td>1</td><td>412</td><td>442</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>1503960366</td><td>4/16/2016 12:00:00 AM</td><td>2</td><td>340</td><td>367</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>1503960366</td><td>4/17/2016 12:00:00 AM</td><td>1</td><td>700</td><td>712</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>1503960366</td><td>4/19/2016 12:00:00 AM</td><td>1</td><td>304</td><td>320</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 6 × 5\n",
       "\\begin{tabular}{r|lllll}\n",
       "  & Id & SleepDay & TotalSleepRecords & TotalMinutesAsleep & TotalTimeInBed\\\\\n",
       "  & <dbl> & <chr> & <int> & <int> & <int>\\\\\n",
       "\\hline\n",
       "\t1 & 1503960366 & 4/12/2016 12:00:00 AM & 1 & 327 & 346\\\\\n",
       "\t2 & 1503960366 & 4/13/2016 12:00:00 AM & 2 & 384 & 407\\\\\n",
       "\t3 & 1503960366 & 4/15/2016 12:00:00 AM & 1 & 412 & 442\\\\\n",
       "\t4 & 1503960366 & 4/16/2016 12:00:00 AM & 2 & 340 & 367\\\\\n",
       "\t5 & 1503960366 & 4/17/2016 12:00:00 AM & 1 & 700 & 712\\\\\n",
       "\t6 & 1503960366 & 4/19/2016 12:00:00 AM & 1 & 304 & 320\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 6 × 5\n",
       "\n",
       "| <!--/--> | Id &lt;dbl&gt; | SleepDay &lt;chr&gt; | TotalSleepRecords &lt;int&gt; | TotalMinutesAsleep &lt;int&gt; | TotalTimeInBed &lt;int&gt; |\n",
       "|---|---|---|---|---|---|\n",
       "| 1 | 1503960366 | 4/12/2016 12:00:00 AM | 1 | 327 | 346 |\n",
       "| 2 | 1503960366 | 4/13/2016 12:00:00 AM | 2 | 384 | 407 |\n",
       "| 3 | 1503960366 | 4/15/2016 12:00:00 AM | 1 | 412 | 442 |\n",
       "| 4 | 1503960366 | 4/16/2016 12:00:00 AM | 2 | 340 | 367 |\n",
       "| 5 | 1503960366 | 4/17/2016 12:00:00 AM | 1 | 700 | 712 |\n",
       "| 6 | 1503960366 | 4/19/2016 12:00:00 AM | 1 | 304 | 320 |\n",
       "\n"
      ],
      "text/plain": [
       "  Id         SleepDay              TotalSleepRecords TotalMinutesAsleep\n",
       "1 1503960366 4/12/2016 12:00:00 AM 1                 327               \n",
       "2 1503960366 4/13/2016 12:00:00 AM 2                 384               \n",
       "3 1503960366 4/15/2016 12:00:00 AM 1                 412               \n",
       "4 1503960366 4/16/2016 12:00:00 AM 2                 340               \n",
       "5 1503960366 4/17/2016 12:00:00 AM 1                 700               \n",
       "6 1503960366 4/19/2016 12:00:00 AM 1                 304               \n",
       "  TotalTimeInBed\n",
       "1 346           \n",
       "2 407           \n",
       "3 442           \n",
       "4 367           \n",
       "5 712           \n",
       "6 320           "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "str(daily_sleep)\n",
    "head(daily_sleep)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "fba6dde4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:06.876152Z",
     "iopub.status.busy": "2024-09-10T04:48:06.874471Z",
     "iopub.status.idle": "2024-09-10T04:48:06.911277Z",
     "shell.execute_reply": "2024-09-10T04:48:06.908661Z"
    },
    "papermill": {
     "duration": 0.050635,
     "end_time": "2024-09-10T04:48:06.914758",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.864123",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "'data.frame':\t22099 obs. of  4 variables:\n",
      " $ Id              : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...\n",
      " $ ActivityHour    : chr  \"4/12/2016 12:00:00 AM\" \"4/12/2016 1:00:00 AM\" \"4/12/2016 2:00:00 AM\" \"4/12/2016 3:00:00 AM\" ...\n",
      " $ TotalIntensity  : int  20 8 7 0 0 0 0 0 13 30 ...\n",
      " $ AverageIntensity: num  0.333 0.133 0.117 0 0 ...\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 6 × 4</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>Id</th><th scope=col>ActivityHour</th><th scope=col>TotalIntensity</th><th scope=col>AverageIntensity</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>1</th><td>1503960366</td><td>4/12/2016 12:00:00 AM</td><td>20</td><td>0.333333</td></tr>\n",
       "\t<tr><th scope=row>2</th><td>1503960366</td><td>4/12/2016 1:00:00 AM </td><td> 8</td><td>0.133333</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>1503960366</td><td>4/12/2016 2:00:00 AM </td><td> 7</td><td>0.116667</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>1503960366</td><td>4/12/2016 3:00:00 AM </td><td> 0</td><td>0.000000</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>1503960366</td><td>4/12/2016 4:00:00 AM </td><td> 0</td><td>0.000000</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>1503960366</td><td>4/12/2016 5:00:00 AM </td><td> 0</td><td>0.000000</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 6 × 4\n",
       "\\begin{tabular}{r|llll}\n",
       "  & Id & ActivityHour & TotalIntensity & AverageIntensity\\\\\n",
       "  & <dbl> & <chr> & <int> & <dbl>\\\\\n",
       "\\hline\n",
       "\t1 & 1503960366 & 4/12/2016 12:00:00 AM & 20 & 0.333333\\\\\n",
       "\t2 & 1503960366 & 4/12/2016 1:00:00 AM  &  8 & 0.133333\\\\\n",
       "\t3 & 1503960366 & 4/12/2016 2:00:00 AM  &  7 & 0.116667\\\\\n",
       "\t4 & 1503960366 & 4/12/2016 3:00:00 AM  &  0 & 0.000000\\\\\n",
       "\t5 & 1503960366 & 4/12/2016 4:00:00 AM  &  0 & 0.000000\\\\\n",
       "\t6 & 1503960366 & 4/12/2016 5:00:00 AM  &  0 & 0.000000\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 6 × 4\n",
       "\n",
       "| <!--/--> | Id &lt;dbl&gt; | ActivityHour &lt;chr&gt; | TotalIntensity &lt;int&gt; | AverageIntensity &lt;dbl&gt; |\n",
       "|---|---|---|---|---|\n",
       "| 1 | 1503960366 | 4/12/2016 12:00:00 AM | 20 | 0.333333 |\n",
       "| 2 | 1503960366 | 4/12/2016 1:00:00 AM  |  8 | 0.133333 |\n",
       "| 3 | 1503960366 | 4/12/2016 2:00:00 AM  |  7 | 0.116667 |\n",
       "| 4 | 1503960366 | 4/12/2016 3:00:00 AM  |  0 | 0.000000 |\n",
       "| 5 | 1503960366 | 4/12/2016 4:00:00 AM  |  0 | 0.000000 |\n",
       "| 6 | 1503960366 | 4/12/2016 5:00:00 AM  |  0 | 0.000000 |\n",
       "\n"
      ],
      "text/plain": [
       "  Id         ActivityHour          TotalIntensity AverageIntensity\n",
       "1 1503960366 4/12/2016 12:00:00 AM 20             0.333333        \n",
       "2 1503960366 4/12/2016 1:00:00 AM   8             0.133333        \n",
       "3 1503960366 4/12/2016 2:00:00 AM   7             0.116667        \n",
       "4 1503960366 4/12/2016 3:00:00 AM   0             0.000000        \n",
       "5 1503960366 4/12/2016 4:00:00 AM   0             0.000000        \n",
       "6 1503960366 4/12/2016 5:00:00 AM   0             0.000000        "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "str(hourly_intensities)\n",
    "head(hourly_intensities)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d732166e",
   "metadata": {
    "papermill": {
     "duration": 0.008677,
     "end_time": "2024-09-10T04:48:06.932189",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.923512",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "We will have to correct the formatting of the column \n",
    "* **ActivityDay**, in tables `daily_calories`, `daily_steps`, `daily_intensities`\n",
    "* **ActivityDate** in `daily_activity` table and \n",
    "* **DailySleep** in table `daily_sleep` from character type to date type. \n",
    "* The **ActivityHour** column of the table `hourly_intensities` will need to bve formatted from chr to date and time format."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "99fca754",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:06.953641Z",
     "iopub.status.busy": "2024-09-10T04:48:06.951940Z",
     "iopub.status.idle": "2024-09-10T04:48:07.024403Z",
     "shell.execute_reply": "2024-09-10T04:48:07.022517Z"
    },
    "papermill": {
     "duration": 0.087184,
     "end_time": "2024-09-10T04:48:07.027980",
     "exception": false,
     "start_time": "2024-09-10T04:48:06.940796",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# changing the ActivityDate format for daily_activity\n",
    "daily_activity$ActivityDate <- as.Date(daily_activity$ActivityDate, format = \"%m/%d/%Y\")\n",
    "\n",
    "# changing the ActivityDay format for daily_calories\n",
    "daily_calories$ActivityDay <- as.Date(daily_calories$ActivityDay, format = \"%m/%d/%Y\")\n",
    "\n",
    "# changing the ActivityDay format for daily_steps\n",
    "daily_steps$ActivityDay <- as.Date(daily_steps$ActivityDay, format = '%m/%d/%Y')\n",
    "\n",
    "# changing the ActivityDay format for daily_intensities\n",
    "daily_intensities$ActivityDay <- as.Date(daily_intensities$ActivityDay, format = \"%m/%d/%Y\")\n",
    "\n",
    "# changing the SleepDay format for daily_sleep\n",
    "daily_sleep$SleepDay <- as.Date(daily_sleep$SleepDay, format = \"%m/%d/%Y\")\n",
    "\n",
    "# changing the ActivityHour format for hourly_intensities\n",
    "hourly_intensities$ActivityHour <- as.POSIXct(hourly_intensities$ActivityHour, format = \"%m/%d/%Y %I:%M:%S %p\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "8e5a9239",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:07.048610Z",
     "iopub.status.busy": "2024-09-10T04:48:07.046907Z",
     "iopub.status.idle": "2024-09-10T04:48:07.099428Z",
     "shell.execute_reply": "2024-09-10T04:48:07.097133Z"
    },
    "papermill": {
     "duration": 0.06623,
     "end_time": "2024-09-10T04:48:07.102613",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.036383",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "33"
      ],
      "text/latex": [
       "33"
      ],
      "text/markdown": [
       "33"
      ],
      "text/plain": [
       "[1] 33"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "33"
      ],
      "text/latex": [
       "33"
      ],
      "text/markdown": [
       "33"
      ],
      "text/plain": [
       "[1] 33"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "33"
      ],
      "text/latex": [
       "33"
      ],
      "text/markdown": [
       "33"
      ],
      "text/plain": [
       "[1] 33"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "33"
      ],
      "text/latex": [
       "33"
      ],
      "text/markdown": [
       "33"
      ],
      "text/plain": [
       "[1] 33"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "24"
      ],
      "text/latex": [
       "24"
      ],
      "text/markdown": [
       "24"
      ],
      "text/plain": [
       "[1] 24"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "33"
      ],
      "text/latex": [
       "33"
      ],
      "text/markdown": [
       "33"
      ],
      "text/plain": [
       "[1] 33"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "n_distinct(daily_activity$Id)\n",
    "n_distinct(daily_calories$Id)\n",
    "n_distinct(daily_steps$Id)\n",
    "n_distinct(daily_intensities$Id)\n",
    "n_distinct(daily_sleep$Id)\n",
    "n_distinct(hourly_intensities$Id)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5ed63cc1",
   "metadata": {
    "papermill": {
     "duration": 0.009249,
     "end_time": "2024-09-10T04:48:07.121117",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.111868",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "`daily_sleep` has only 24 participants' data. This shows some participants would rather not wear the device while sleeping. Considering a data set of only 33 paritcipants about 27% of people chose not to use the device at during sleep time.\n",
    "\n",
    "Bellabeat could provide notifications on their app, spreading the awareness about how tracking sleep data can be helpful in providing better insights about their body and help them in their health and fitness goals or journey."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "9015b2c0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:07.143700Z",
     "iopub.status.busy": "2024-09-10T04:48:07.141700Z",
     "iopub.status.idle": "2024-09-10T04:48:07.190360Z",
     "shell.execute_reply": "2024-09-10T04:48:07.187393Z"
    },
    "papermill": {
     "duration": 0.063399,
     "end_time": "2024-09-10T04:48:07.193679",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.130280",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1] \"Summary of of daily_activity table: \"\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "   TotalSteps    VeryActiveMinutes FairlyActiveMinutes LightlyActiveMinutes\n",
       " Min.   :    0   Min.   :  0.00    Min.   :  0.00      Min.   :  0.0       \n",
       " 1st Qu.: 3790   1st Qu.:  0.00    1st Qu.:  0.00      1st Qu.:127.0       \n",
       " Median : 7406   Median :  4.00    Median :  6.00      Median :199.0       \n",
       " Mean   : 7638   Mean   : 21.16    Mean   : 13.56      Mean   :192.8       \n",
       " 3rd Qu.:10727   3rd Qu.: 32.00    3rd Qu.: 19.00      3rd Qu.:264.0       \n",
       " Max.   :36019   Max.   :210.00    Max.   :143.00      Max.   :518.0       \n",
       " SedentaryMinutes    Calories   \n",
       " Min.   :   0.0   Min.   :   0  \n",
       " 1st Qu.: 729.8   1st Qu.:1828  \n",
       " Median :1057.5   Median :2134  \n",
       " Mean   : 991.2   Mean   :2304  \n",
       " 3rd Qu.:1229.5   3rd Qu.:2793  \n",
       " Max.   :1440.0   Max.   :4900  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Summarizing the data from the columns that we are interested in from the daily_activity table\n",
    "columns_daily_activity <- daily_activity[c(\"TotalSteps\", \"VeryActiveMinutes\", \"FairlyActiveMinutes\", \"LightlyActiveMinutes\", \"SedentaryMinutes\", \"Calories\")]\n",
    "print('Summary of of daily_activity table: ')\n",
    "summary(columns_daily_activity)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "47a49929",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:07.216522Z",
     "iopub.status.busy": "2024-09-10T04:48:07.214837Z",
     "iopub.status.idle": "2024-09-10T04:48:07.241681Z",
     "shell.execute_reply": "2024-09-10T04:48:07.239342Z"
    },
    "papermill": {
     "duration": 0.041382,
     "end_time": "2024-09-10T04:48:07.244685",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.203303",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1] \"Summary of TotalMinutesAsleep in daily_sleep table\"\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       " TotalMinutesAsleep TotalSleepRecords\n",
       " Min.   : 58.0      Min.   :1.000    \n",
       " 1st Qu.:361.0      1st Qu.:1.000    \n",
       " Median :433.0      Median :1.000    \n",
       " Mean   :419.5      Mean   :1.119    \n",
       " 3rd Qu.:490.0      3rd Qu.:1.000    \n",
       " Max.   :796.0      Max.   :3.000    "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "columns_daily_sleep <- daily_sleep[c(\"TotalMinutesAsleep\", \"TotalSleepRecords\")]\n",
    "print('Summary of TotalMinutesAsleep in daily_sleep table')\n",
    "summary(columns_daily_sleep)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c0fd68e9",
   "metadata": {
    "papermill": {
     "duration": 0.009886,
     "end_time": "2024-09-10T04:48:07.264248",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.254362",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "* The mean of total steps is 7638 which is below the recommended steps count of at least 10000 steps  per day as of The Centers for Disease Control and Prevention (CDC). **Referenced from:** [LINK](https://www.cdc.gov/pcd/issues/2016/pdf/16_0111.pdf) \n",
    "* More than 50% of the subjects we are working with fail to meet the requirements.\n",
    "* Majority of the people are only lightly active.\n",
    "* The average sedentary minutes is around 991 minutes which is quite a lot and can have adverse health effects on the people in the long run.\n",
    "* The average sleep time of participants of the survey were just less than 7 hours, and they slept once a day."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6f41648b",
   "metadata": {
    "papermill": {
     "duration": 0.009521,
     "end_time": "2024-09-10T04:48:07.283473",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.273952",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "We can find the days, people walked most steps and remained most active. This can help the company strategise it's marketting notifications for the mobile app."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b2df70e2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:07.306818Z",
     "iopub.status.busy": "2024-09-10T04:48:07.305020Z",
     "iopub.status.idle": "2024-09-10T04:48:07.350302Z",
     "shell.execute_reply": "2024-09-10T04:48:07.348403Z"
    },
    "papermill": {
     "duration": 0.060502,
     "end_time": "2024-09-10T04:48:07.353750",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.293248",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "steps_by_weekday <- daily_activity %>%\n",
    "    mutate(WeekDay = weekdays(ActivityDate))\n",
    "\n",
    "steps_by_weekday <- steps_by_weekday %>%\n",
    "    group_by(WeekDay) %>%\n",
    "    summarize(AverageDailySteps = mean(TotalSteps), \n",
    "              AverageDailyActivity = mean(VeryActiveMinutes + FairlyActiveMinutes), \n",
    "              DailyInactivity = mean(SedentaryMinutes))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "f0e87380",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:07.377538Z",
     "iopub.status.busy": "2024-09-10T04:48:07.375862Z",
     "iopub.status.idle": "2024-09-10T04:48:07.408543Z",
     "shell.execute_reply": "2024-09-10T04:48:07.405570Z"
    },
    "papermill": {
     "duration": 0.047927,
     "end_time": "2024-09-10T04:48:07.411851",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.363924",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A tibble: 7 × 4</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>WeekDay</th><th scope=col>AverageDailySteps</th><th scope=col>AverageDailyActivity</th><th scope=col>DailyInactivity</th></tr>\n",
       "\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>Friday   </td><td>7448.230</td><td>32.16667</td><td>1000.3095</td></tr>\n",
       "\t<tr><td>Monday   </td><td>7780.867</td><td>37.10833</td><td>1027.9417</td></tr>\n",
       "\t<tr><td>Saturday </td><td>8152.976</td><td>37.12097</td><td> 964.2823</td></tr>\n",
       "\t<tr><td>Sunday   </td><td>6933.231</td><td>34.51240</td><td> 990.2562</td></tr>\n",
       "\t<tr><td>Thursday </td><td>7405.837</td><td>31.36735</td><td> 961.9932</td></tr>\n",
       "\t<tr><td>Tuesday  </td><td>8125.007</td><td>37.28947</td><td>1007.3618</td></tr>\n",
       "\t<tr><td>Wednesday</td><td>7559.373</td><td>33.88000</td><td> 989.4800</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A tibble: 7 × 4\n",
       "\\begin{tabular}{llll}\n",
       " WeekDay & AverageDailySteps & AverageDailyActivity & DailyInactivity\\\\\n",
       " <chr> & <dbl> & <dbl> & <dbl>\\\\\n",
       "\\hline\n",
       "\t Friday    & 7448.230 & 32.16667 & 1000.3095\\\\\n",
       "\t Monday    & 7780.867 & 37.10833 & 1027.9417\\\\\n",
       "\t Saturday  & 8152.976 & 37.12097 &  964.2823\\\\\n",
       "\t Sunday    & 6933.231 & 34.51240 &  990.2562\\\\\n",
       "\t Thursday  & 7405.837 & 31.36735 &  961.9932\\\\\n",
       "\t Tuesday   & 8125.007 & 37.28947 & 1007.3618\\\\\n",
       "\t Wednesday & 7559.373 & 33.88000 &  989.4800\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A tibble: 7 × 4\n",
       "\n",
       "| WeekDay &lt;chr&gt; | AverageDailySteps &lt;dbl&gt; | AverageDailyActivity &lt;dbl&gt; | DailyInactivity &lt;dbl&gt; |\n",
       "|---|---|---|---|\n",
       "| Friday    | 7448.230 | 32.16667 | 1000.3095 |\n",
       "| Monday    | 7780.867 | 37.10833 | 1027.9417 |\n",
       "| Saturday  | 8152.976 | 37.12097 |  964.2823 |\n",
       "| Sunday    | 6933.231 | 34.51240 |  990.2562 |\n",
       "| Thursday  | 7405.837 | 31.36735 |  961.9932 |\n",
       "| Tuesday   | 8125.007 | 37.28947 | 1007.3618 |\n",
       "| Wednesday | 7559.373 | 33.88000 |  989.4800 |\n",
       "\n"
      ],
      "text/plain": [
       "  WeekDay   AverageDailySteps AverageDailyActivity DailyInactivity\n",
       "1 Friday    7448.230          32.16667             1000.3095      \n",
       "2 Monday    7780.867          37.10833             1027.9417      \n",
       "3 Saturday  8152.976          37.12097              964.2823      \n",
       "4 Sunday    6933.231          34.51240              990.2562      \n",
       "5 Thursday  7405.837          31.36735              961.9932      \n",
       "6 Tuesday   8125.007          37.28947             1007.3618      \n",
       "7 Wednesday 7559.373          33.88000              989.4800      "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "steps_by_weekday"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "3aedde71",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:07.435731Z",
     "iopub.status.busy": "2024-09-10T04:48:07.434041Z",
     "iopub.status.idle": "2024-09-10T04:48:07.459614Z",
     "shell.execute_reply": "2024-09-10T04:48:07.457727Z"
    },
    "papermill": {
     "duration": 0.04112,
     "end_time": "2024-09-10T04:48:07.462952",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.421832",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "sleep_by_weekday <- daily_sleep %>%\n",
    "    mutate(WeekDay = weekdays(SleepDay))\n",
    "\n",
    "sleep_by_weekday <- sleep_by_weekday %>%\n",
    "    group_by(WeekDay) %>%\n",
    "    summarize(TotalMinutesAsleep = mean(TotalMinutesAsleep))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "c7fa7fab",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:07.486892Z",
     "iopub.status.busy": "2024-09-10T04:48:07.485200Z",
     "iopub.status.idle": "2024-09-10T04:48:07.514246Z",
     "shell.execute_reply": "2024-09-10T04:48:07.511295Z"
    },
    "papermill": {
     "duration": 0.044599,
     "end_time": "2024-09-10T04:48:07.517809",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.473210",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A tibble: 7 × 2</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>WeekDay</th><th scope=col>TotalMinutesAsleep</th></tr>\n",
       "\t<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>Friday   </td><td>405.4211</td></tr>\n",
       "\t<tr><td>Monday   </td><td>418.8298</td></tr>\n",
       "\t<tr><td>Saturday </td><td>420.8103</td></tr>\n",
       "\t<tr><td>Sunday   </td><td>452.7455</td></tr>\n",
       "\t<tr><td>Thursday </td><td>402.3692</td></tr>\n",
       "\t<tr><td>Tuesday  </td><td>404.5385</td></tr>\n",
       "\t<tr><td>Wednesday</td><td>434.6818</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A tibble: 7 × 2\n",
       "\\begin{tabular}{ll}\n",
       " WeekDay & TotalMinutesAsleep\\\\\n",
       " <chr> & <dbl>\\\\\n",
       "\\hline\n",
       "\t Friday    & 405.4211\\\\\n",
       "\t Monday    & 418.8298\\\\\n",
       "\t Saturday  & 420.8103\\\\\n",
       "\t Sunday    & 452.7455\\\\\n",
       "\t Thursday  & 402.3692\\\\\n",
       "\t Tuesday   & 404.5385\\\\\n",
       "\t Wednesday & 434.6818\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A tibble: 7 × 2\n",
       "\n",
       "| WeekDay &lt;chr&gt; | TotalMinutesAsleep &lt;dbl&gt; |\n",
       "|---|---|\n",
       "| Friday    | 405.4211 |\n",
       "| Monday    | 418.8298 |\n",
       "| Saturday  | 420.8103 |\n",
       "| Sunday    | 452.7455 |\n",
       "| Thursday  | 402.3692 |\n",
       "| Tuesday   | 404.5385 |\n",
       "| Wednesday | 434.6818 |\n",
       "\n"
      ],
      "text/plain": [
       "  WeekDay   TotalMinutesAsleep\n",
       "1 Friday    405.4211          \n",
       "2 Monday    418.8298          \n",
       "3 Saturday  420.8103          \n",
       "4 Sunday    452.7455          \n",
       "5 Thursday  402.3692          \n",
       "6 Tuesday   404.5385          \n",
       "7 Wednesday 434.6818          "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "sleep_by_weekday"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "4f16ca1b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:07.541871Z",
     "iopub.status.busy": "2024-09-10T04:48:07.540219Z",
     "iopub.status.idle": "2024-09-10T04:48:07.563966Z",
     "shell.execute_reply": "2024-09-10T04:48:07.562133Z"
    },
    "papermill": {
     "duration": 0.039244,
     "end_time": "2024-09-10T04:48:07.567337",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.528093",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# merging two tables by 'WeekDay' column\n",
    "sleep_steps_merged <- merge(steps_by_weekday, sleep_by_weekday, by = \"WeekDay\")\n",
    "\n",
    "sleep_steps_merged$WeekDay <- ordered(sleep_steps_merged$WeekDay, \n",
    "                                      levels = c(\"Monday\", \"Tuesday\", \n",
    "                                                 \"Wednesday\", \"Thursday\", \n",
    "                                                 \"Friday\", \"Saturday\", \"Sunday\"))\n",
    "\n",
    "sleep_steps_merged <- sleep_steps_merged[order(sleep_steps_merged$WeekDay), ]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "cb65f43c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-10T04:48:07.591485Z",
     "iopub.status.busy": "2024-09-10T04:48:07.589818Z",
     "iopub.status.idle": "2024-09-10T04:48:07.626269Z",
     "shell.execute_reply": "2024-09-10T04:48:07.616801Z"
    },
    "papermill": {
     "duration": 0.052023,
     "end_time": "2024-09-10T04:48:07.629695",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.577672",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 7 × 5</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>WeekDay</th><th scope=col>AverageDailySteps</th><th scope=col>AverageDailyActivity</th><th scope=col>DailyInactivity</th><th scope=col>TotalMinutesAsleep</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;ord&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>2</th><td>Monday   </td><td>7780.867</td><td>37.10833</td><td>1027.9417</td><td>418.8298</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>Tuesday  </td><td>8125.007</td><td>37.28947</td><td>1007.3618</td><td>404.5385</td></tr>\n",
       "\t<tr><th scope=row>7</th><td>Wednesday</td><td>7559.373</td><td>33.88000</td><td> 989.4800</td><td>434.6818</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>Thursday </td><td>7405.837</td><td>31.36735</td><td> 961.9932</td><td>402.3692</td></tr>\n",
       "\t<tr><th scope=row>1</th><td>Friday   </td><td>7448.230</td><td>32.16667</td><td>1000.3095</td><td>405.4211</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>Saturday </td><td>8152.976</td><td>37.12097</td><td> 964.2823</td><td>420.8103</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>Sunday   </td><td>6933.231</td><td>34.51240</td><td> 990.2562</td><td>452.7455</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 7 × 5\n",
       "\\begin{tabular}{r|lllll}\n",
       "  & WeekDay & AverageDailySteps & AverageDailyActivity & DailyInactivity & TotalMinutesAsleep\\\\\n",
       "  & <ord> & <dbl> & <dbl> & <dbl> & <dbl>\\\\\n",
       "\\hline\n",
       "\t2 & Monday    & 7780.867 & 37.10833 & 1027.9417 & 418.8298\\\\\n",
       "\t6 & Tuesday   & 8125.007 & 37.28947 & 1007.3618 & 404.5385\\\\\n",
       "\t7 & Wednesday & 7559.373 & 33.88000 &  989.4800 & 434.6818\\\\\n",
       "\t5 & Thursday  & 7405.837 & 31.36735 &  961.9932 & 402.3692\\\\\n",
       "\t1 & Friday    & 7448.230 & 32.16667 & 1000.3095 & 405.4211\\\\\n",
       "\t3 & Saturday  & 8152.976 & 37.12097 &  964.2823 & 420.8103\\\\\n",
       "\t4 & Sunday    & 6933.231 & 34.51240 &  990.2562 & 452.7455\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 7 × 5\n",
       "\n",
       "| <!--/--> | WeekDay &lt;ord&gt; | AverageDailySteps &lt;dbl&gt; | AverageDailyActivity &lt;dbl&gt; | DailyInactivity &lt;dbl&gt; | TotalMinutesAsleep &lt;dbl&gt; |\n",
       "|---|---|---|---|---|---|\n",
       "| 2 | Monday    | 7780.867 | 37.10833 | 1027.9417 | 418.8298 |\n",
       "| 6 | Tuesday   | 8125.007 | 37.28947 | 1007.3618 | 404.5385 |\n",
       "| 7 | Wednesday | 7559.373 | 33.88000 |  989.4800 | 434.6818 |\n",
       "| 5 | Thursday  | 7405.837 | 31.36735 |  961.9932 | 402.3692 |\n",
       "| 1 | Friday    | 7448.230 | 32.16667 | 1000.3095 | 405.4211 |\n",
       "| 3 | Saturday  | 8152.976 | 37.12097 |  964.2823 | 420.8103 |\n",
       "| 4 | Sunday    | 6933.231 | 34.51240 |  990.2562 | 452.7455 |\n",
       "\n"
      ],
      "text/plain": [
       "  WeekDay   AverageDailySteps AverageDailyActivity DailyInactivity\n",
       "2 Monday    7780.867          37.10833             1027.9417      \n",
       "6 Tuesday   8125.007          37.28947             1007.3618      \n",
       "7 Wednesday 7559.373          33.88000              989.4800      \n",
       "5 Thursday  7405.837          31.36735              961.9932      \n",
       "1 Friday    7448.230          32.16667             1000.3095      \n",
       "3 Saturday  8152.976          37.12097              964.2823      \n",
       "4 Sunday    6933.231          34.51240              990.2562      \n",
       "  TotalMinutesAsleep\n",
       "2 418.8298          \n",
       "6 404.5385          \n",
       "7 434.6818          \n",
       "5 402.3692          \n",
       "1 405.4211          \n",
       "3 420.8103          \n",
       "4 452.7455          "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "sleep_steps_merged"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2b5f9e11",
   "metadata": {
    "papermill": {
     "duration": 0.010371,
     "end_time": "2024-09-10T04:48:07.650658",
     "exception": false,
     "start_time": "2024-09-10T04:48:07.640287",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 1041311,
     "sourceId": 7746251,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30749,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "r",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "4.4.0"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 6.277243,
   "end_time": "2024-09-10T04:48:07.783284",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-09-10T04:48:01.506041",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
